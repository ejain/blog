<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><meta name="author" content="Eric Jain"><title>Fake Trails - Eric Jain's Blog</title><link rel="alternate" type="application/rss+xml" title="Eric Jain's Blog" href="/atom.xml"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"></head><body><nav class="navbar navbar-default navbar-custom"><div class="container-fluid"><div class="navbar-header"><a href="/" class="navbar-brand">Eric Jain's Blog</a></div></div></nav><header class="header-section"><div class="intro-header no-img"><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class="post-heading"><h1>Fake Trails</h1><p class="post-meta">October 25, 2018 · <a href="/tags/programming/" class="tag post-meta">Programming</a></p></div></div></div></div></div></header><div class="container"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role="main" class="blog-post"><p>One in five pictures I take while hiking are pictures of the trails themselves. Previously, I experimented with <a href="https://github.com/ejain/n-of-1-ml/blob/master/transfer_learning.ipynb">using machine learning to automatically tag those pictures</a>. After reading about how machine learning can be used not just for image classification, but also for <a href="https://arxiv.org/abs/1511.06434">generating images</a>, I was curious to see what would happen if I tried this approach on my pictures.</p>
<p>Here are a few randomly selected pictures of trails, out of the more than 5,000 pictures of trails I have taken over the past 10 years:</p>
<p><img src="real_samples.png" alt="actual trails"></p>
<p>After a bit of number crunching with a <em>Deep Convolutional Generative Adversarial Network</em> (where part of the network is trained to fake images, while the other part is simultaneously being trained to detect fake images), here are a few randomly generated trail pictures: </p>
<p><img src="fake_samples_epoch_275.png" alt="fake trails"></p>
<p>There is some blurriness and some distortions, but overall the results are pretty convincing! There are forest trails, trails through alpine meadows, rocky trails, and even a few snow-covered trails. But none of these trails exist in the real world.</p>
<h2 id="Notes"><a href="#Notes" class="headerlink" title="Notes"></a>Notes</h2><ul>
<li><p>I ended up using <a href="https://pytorch.org/">PyTorch</a>, which happened to have <a href="https://github.com/pytorch/examples/tree/master/dcgan">suitable sample code</a>. <a href="https://keras.io/">Keras</a> (my go-to framework) turned out to be a bit too high-level to handle this kind of problem efficiently, and <a href="https://www.tensorflow.org/">Tensorflow</a>, being more low-level, would have required more code.</p>
</li>
<li><p>Unfortunately, scaling up beyond 64x64 thumbnails to 128x128 or larger turns out to not be a simple matter of throwing more computing resources at the problem.</p>
</li>
<li><p>The network was trained for 275 epochs (iterations through the entire data set). This animation shows how the generated images improved over time: </p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/EtQbLnecW0g" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
</li>
<li><p>The training was done on a fast machine with a GPU (obtained from <a href="https://aws.amazon.com/sagemaker/">Amazon SageMaker</a> for a total cost of about $2); running the same code on my laptop would have taken days, rather than just under an hour.</p>
</li>
<li><p>Found <a href="https://github.com/soumith/ganhacks">this list of tips</a> that might further improve the results.</p>
</li>
</ul>
</article></div></div></div><footer><div class="container beautiful-jekyll-footer"><div class="row"><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"><li><a href="/atom.xml" title="RSS"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-rss"></i></span></a></li><li><a href="mailto:eric.jain@gmail.com" title="Email me"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-envelope"></i></span></a></li><li><a href="https://www.linkedin.com/in/ejain" title="LinkedIn"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-linkedin"></i></span></a></li><li><a href="https://github.com/ejain" title="GitHub"><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-stack-1x fa-inverse fa-github"></i></span></a></li></ul><p class="copyright text-muted">© 2020 Eric Jain</p></div></div></div></footer><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-112726-2', 'auto');
ga('send', 'pageview');</script></body></html>